#!/usr/bin/env ruby

require_relative '../lib/modules/file_helper'
require_relative '../lib/modules/rules_helper'
require_relative '../lib/modules/validations_helper'
require_relative '../lib/modules/variables_helper'

input_array = ARGV
if !FileValidation.validate_path?(input_array[0])
  puts "We need a file: #{__FILE__} <name>"
  exit(2)
elsif !FileValidation.file_is_sass_file?(input_array[0])
  puts 'Please choose a file with the type : .scss'
  exit(2)
elsif !FileValidation.file_exists?(input_array[0])
  puts 'The file does not exists'
  exit(2)
elsif !FileValidation.file_is_readable?(input_array[0])
  puts "We can't not read this file"
  exit(2)
elsif FileValidation.file_have_zero_lines?(input_array[0])
  puts 'The file is valid but is empty'
  exit(2)
end

total_lines = File.open(input_array[0]).count

row = 1
File.open(input_array[0]).each_with_index do |line, _idx|
  LineValidations.comment_white_space_inside_validations(line, row)
  LineValidations.unexpected_missing_end_of_source_newline(line, row) if total_lines == row
  row += 1
end

LineValidations.expected_empty_line_before_comment(File.open(input_array[0]))

arr = LineValidations.show_list_errors
# ordered_by_row = LineValidations.order_array_by_row(arr)
# ordered_by_column = LineValidations.order_array_by_column(ordered_by_row)
arr.each { |x| p x.show_message unless x.nil? }

# n = x =~ %r{/\*}
# m = x =~ %r{\*/}
# p line_file.match(/\n/)
